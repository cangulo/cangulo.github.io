<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="alternate" type="application/rss+xml" href="/cheatsheets/rss.xml" title="Carlos Angulo Cheatsheets RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/cheatsheets/atom.xml" title="Carlos Angulo Cheatsheets Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/books/rss.xml" title="Carlos Angulo Recommended Books RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/books/atom.xml" title="Carlos Angulo Recommended Books Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/projects/rss.xml" title="Carlos Angulo Projects RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/projects/atom.xml" title="Carlos Angulo Projects Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/meetups/rss.xml" title="Carlos Angulo Meetups RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/meetups/atom.xml" title="Carlos Angulo Meetups Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Carlos Angulo Posts RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Carlos Angulo Posts Atom Feed"><title data-react-helmet="true">AWS Control Tower - Reducing Cost 2 | Carlos Angulo</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://cangulo.github.io/blog/aws/control-tower/2-disable-config-in-aft-account"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="AWS Control Tower - Reducing Cost 2 | Carlos Angulo"><meta data-react-helmet="true" name="description" content="In this post I&#x27;m going to talk about the costs I faced using AWS Control Tower the latest 3 months. I recommend you read my previous post before continuing. Basic knowledge about AWS Control Tower is required."><meta data-react-helmet="true" property="og:description" content="In this post I&#x27;m going to talk about the costs I faced using AWS Control Tower the latest 3 months. I recommend you read my previous post before continuing. Basic knowledge about AWS Control Tower is required."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-04-22T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/cangulo"><meta data-react-helmet="true" property="article:tag" content="aws,projects,accounts,setup,costs,aws-control-tower"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://cangulo.github.io/blog/aws/control-tower/2-disable-config-in-aft-account"><link data-react-helmet="true" rel="alternate" href="https://cangulo.github.io/blog/aws/control-tower/2-disable-config-in-aft-account" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://cangulo.github.io/blog/aws/control-tower/2-disable-config-in-aft-account" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.55d22ede.css">
<link rel="preload" href="/assets/js/runtime~main.20589720.js" as="script">
<link rel="preload" href="/assets/js/main.9d51b9f2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/cheatsheets">Cheatsheets</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a class="navbar__item navbar__link" href="/meetups">Meetups </a><a class="navbar__item navbar__link" href="/books">Books</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cangulo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleChecked_2FvV toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" checked="" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/aws/control-tower/4-one-year-after">AWS Control Tower - One year using it</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/aws/control-tower/3-replacing-aws-codepipeline">AWS Control Tower - Replacing CodePipelines</a></li><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/blog/aws/control-tower/2-disable-config-in-aft-account">AWS Control Tower - Reducing Cost 2</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/aws/control-tower/1-delete-vpc-endpoints-and-nat">AWS Control Tower - Reducing Cost 1</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/bash/5-interactive-bookmarks-v2">Interactive bookmarks menu v2</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/bash/4-create-config-repo">How to use a repository for importing your bash scripts and shortcuts</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/bash/3-load-vars">Load custom variables at Terminal startup</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/bash/2-add-shortcuts">Add shortcuts to your bash terminal</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/bash/1-interactive-bookmarks">Create an interactive bookmarks menu in your terminal</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/ps-profile-productive">How to use the PowerShell Profile to be more productive</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">AWS Control Tower - Reducing Cost 2</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2022-04-22T00:00:00.000Z" itemprop="datePublished">April 22, 2022</time> · <!-- -->7 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://github.com/cangulo" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://github.com/cangulo/cangulo/raw/main/profile_picture_preview_icon.png" alt="Carlos Angulo Mascarell"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cangulo" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Carlos Angulo Mascarell</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>In this post I&#x27;m going to talk about the costs I faced using AWS Control Tower the latest 3 months. I recommend you read my <a href="/blog/aws/control-tower/1-delete-vpc-endpoints-and-nat">previous post</a> before continuing. Basic knowledge about AWS Control Tower is required.</p></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="latest-3-months-costs">Latest 3 months costs:<a aria-hidden="true" class="hash-link" href="#latest-3-months-costs" title="Direct link to heading">​</a></h2><p>Before I proceed, I have to mention my usage of AFT:</p><ul><li>I only used it during January and February. I created 5 AWS Accounts.</li><li>On March I didn&#x27;t create or enroll any account. </li></ul><p>And here we have the costs:</p><p><img alt="latest 3 months costs" src="/assets/images/costs-latest-3-months-9eaba09962e4eb993636e391267cb176.png"></p><div style="display:flex;justify-content:center"><table><thead><tr><th>Service</th><th align="right">Config($)</th><th align="right">VPC($)</th><th align="right">Tax($)</th><th align="right">EC2-Other($)</th><th align="right">CodeBuild($)</th><th align="right">KMS($)</th><th align="right">Lambda($)</th><th align="right">S3($)</th><th align="right">DynamoDB($)</th><th align="right">Backup($)</th><th align="right">EC2-Instances($)</th><th align="right">CloudWatch($)</th><th align="right">Total cost ($)</th></tr></thead><tbody><tr><td>January</td><td align="right">16.58</td><td align="right">17.34</td><td align="right">10.62</td><td align="right">8.41</td><td align="right">6.62</td><td align="right">1.56</td><td align="right">0.09</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">61.2</td></tr><tr><td>February</td><td align="right">13.9</td><td align="right">12.5</td><td align="right">10.98</td><td align="right">9.04</td><td align="right">8.5</td><td align="right">1.87</td><td align="right">6.44</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">63.22</td></tr><tr><td>March</td><td align="right">9.03</td><td align="right">0</td><td align="right">4.72</td><td align="right">7.44</td><td align="right">0</td><td align="right">6</td><td align="right">0</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0.01</td><td align="right">0</td><td align="right">0</td><td align="right">27.19</td></tr></tbody></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Let&#x27;s ignore the <code>Tax</code> from the plot and table.</p></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="detailed-cost-services-api-operations-and-usages-type">Detailed cost: Services, API Operations and Usages Type<a aria-hidden="true" class="hash-link" href="#detailed-cost-services-api-operations-and-usages-type" title="Direct link to heading">​</a></h3><p>Let me write down the services used:</p><ul><li>AWS Config:<ul><li>API Operation: <code>None</code> </li><li>Usage Type: <code>EU-ConfigurationItemRecorded</code></li></ul></li><li>VPC: <ul><li>API Operation: <code>VpcEndpoint</code> </li><li>Usage Type: <code>EU-VpcEndpoint-Hours</code></li></ul></li><li>EC2-Other:<ul><li>API Operations: <code>NatGateway</code>, <code>AssociateAddressVPC</code>, here are the costs:</li><li>Usage Type: <code>EU-NatGateway-Hours</code>,<code>EU-ElasticIP:IdleAddress</code>, <code>EU-NatGateway-Bytes</code></li></ul></li></ul><div style="display:flex;justify-content:center"><table><thead><tr><th>API Operation</th><th align="right">NatGateway($)</th><th align="right">AssociateAddressVPC($)</th><th align="right">Total</th></tr></thead><tbody><tr><td>January</td><td align="right">7.28</td><td align="right">1.13</td><td align="right">8.41</td></tr><tr><td>February</td><td align="right">7.02</td><td align="right">2.02</td><td align="right">9.04</td></tr><tr><td>March</td><td align="right">0</td><td align="right">7.44</td><td align="right">7.44</td></tr></tbody></table></div><div style="display:flex;justify-content:center"><table><thead><tr><th>Usage Type</th><th align="right">EU-NatGateway-Hours($)</th><th align="right">EU-ElasticIP:IdleAddress($)</th><th align="right">EU-NatGateway-Bytes($)</th></tr></thead><tbody><tr><td>January</td><td align="right">7.2</td><td align="right">1.123</td><td align="right">0.08</td></tr><tr><td>February</td><td align="right">6.24</td><td align="right">2.019</td><td align="right">0.78</td></tr><tr><td>March</td><td align="right"></td><td align="right">7.435</td><td align="right"></td></tr></tbody></table></div><ul><li>CodeBuild: <ul><li>API Operation: <code>Build</code></li><li>No cost on March because no account was created neither enrolled</li></ul></li><li>Key Management Service:<ul><li>API Operation: <code>Unknown</code></li><li>Usage Type: <code>eu-west-1-KMS-Keys</code>,<code>eu-west-2-KMS-Keys</code></li></ul></li></ul><div style="display:flex;justify-content:center"><table><thead><tr><th>Usage Type</th><th align="right">eu-west-1-KMS-Keys($)</th><th align="right">eu-west-2-KMS-Keys($)</th><th align="right">Total</th></tr></thead><tbody><tr><td>January</td><td align="right">1.06</td><td align="right">0.5</td><td align="right">1.56</td></tr><tr><td>February</td><td align="right">1.24</td><td align="right">0.63</td><td align="right">1.87</td></tr><tr><td>March</td><td align="right">4</td><td align="right">2</td><td align="right">6</td></tr></tbody></table></div><ul><li>Lambda:<ul><li>API Operation: <code>Invoke</code></li><li>Usage Type: <code>EU-Lambda-GB-Second</code></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="analysis">Analysis<a aria-hidden="true" class="hash-link" href="#analysis" title="Direct link to heading">​</a></h3><ul><li>The only services that cost independently of usage are:<ul><li>AWS Config</li><li>EC2-Other</li><li>KMS</li></ul></li><li>AWS Config is the highest cost. I will talk about this in the next section: <a href="#what-aws-config-does-can-i-reduce-it-cost">aws config section</a></li><li>Using the improvement to disable the VPC endpoints and NAT explained in my <a href="/blog/aws/control-tower/1-delete-vpc-endpoints-and-nat">previous post</a>, in March the cost is 0 for the following operations:<ul><li><code>EU-VpcEndpoint-Hours</code> - service <code>VPC</code></li><li><code>EU-NatGateway-Hours</code> and <code>EU-NatGateway-Bytes</code> - service <code>EC2-Other</code></li></ul></li><li>However, <strong>there is still a cost in the <code>EC2-Other</code></strong> service, it is for the API Operation <code>AssociateAddressVPC</code> , usage type: <code>EU-ElasticIP:IdleAddress</code>. </li><li>The <strong>KMS cost has increase in March</strong>. I didn&#x27;t expect this one because I didn&#x27;t use AFT during that month.</li><li>Other services ( <code>S3</code> ,<code>DynamoDB</code> ,<code>Backup</code> ,<code>EC2-Instances</code> ,<code>CloudWatch</code> ) have no cost or less than 0.10.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="questions">Questions<a aria-hidden="true" class="hash-link" href="#questions" title="Direct link to heading">​</a></h3><ul><li>What AWS Config does ? Can I reduce it cost ? </li><li>What does the operation <code>EU-ElasticIP:IdleAddress</code> do? How can I decrease this cost? </li><li>Why KMS cost increase in March if I didn&#x27;t use AFT? How can I decrease it?</li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="what-aws-config-does-can-i-reduce-it-cost">What AWS Config does? Can I reduce it cost?<a aria-hidden="true" class="hash-link" href="#what-aws-config-does-can-i-reduce-it-cost" title="Direct link to heading">​</a></h2><p>AWS Config is a AWS service that allow us to record and evaluate resources configurations. You can check the full description <a href="https://aws.amazon.com/config/?nc1=h_ls" target="_blank" rel="noopener noreferrer">here</a>.
This service is been used by the AWS Control Tower as described next:</p><p>AWS Control Tower has a feature named <a href="https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html" target="_blank" rel="noopener noreferrer">Guardrails</a>, those are rules validated against resources created in enrolled accounts. This provides governance to AWS environments.
Those Guardrails can be preventive (ensuring your account maintain compliance) or Detective (detect noncompliance resources) based on the behavior.
The detective guardrails are implemented using AWS Config rules.
This means Control Tower call AWS Config to validate the configuration of the resources when a detective guardrails is active.</p><p>okey, too much theory, the most important, next are the two detective guardrails activated by default in a landing zone:</p><p><img alt="Guardrails detectives" src="/assets/images/guardrails-default-detectives-38e94cd92e5898b3f71353e7b38f3a37.png"></p><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</h5></div><div class="admonition-content"><p>The next approach works for me because I&#x27;m using AFT sporadically and for personal projects. I don&#x27;t recommend it for companies because resource history might be required for compliance.</p></div></div><p>Action done: </p><ol><li>Go to AWS Organizations. Create a OU, I name it <code>outside-act</code>.</li><li>Move the AFT account to the new OU.</li><li>Check it is not enrolled.</li></ol><p><img alt="aws-ct-account-outside-ou" src="/assets/images/aws-ct-account-outside-ou-51cdc1d3df4c2c743f7e4e10368ff2b1.png"></p><ol start="4"><li>Open the AWS Console, login using the AFT Account, go to AWS Config, open Settings, click on <code>Edit</code>. and select stop recording, save it.</li></ol><p><img alt="aws-config-settings" src="/assets/images/aws-config-settings-6e624a69e9718c60f5ff5896e86f9909.png">
<img alt="aws-config-settings-edit" src="/assets/images/aws-config-settings-edit-f6fe670c0c5f6efbbab9beae5d5d78e7.png">
<img alt="aws-config-setting-recorder-off" src="/assets/images/aws-config-setting-recorder-off-b51c0f28cc3df477567431a3e876eb2e.png"></p><p><img alt="costs-after-disable-aws-config-recorder" src="/assets/images/costs-after-disable-aws-config-recorder-60faad4259ebc1624c0372022be4e559.png"></p><p>After disabling Recorder on April 19 the cost was reduced from <code>0.30 $</code> per day to <code>0.03 $</code></p><div style="display:flex;justify-content:center"><table><thead><tr><th>Service</th><th>2022-04-16</th><th>2022-04-17</th><th>2022-04-18</th><th>2022-04-19</th><th>2022-04-20</th><th>2022-04-21</th><th>2022-04-22</th></tr></thead><tbody><tr><td>Config($)</td><td>0.296</td><td><strong>0.296</strong></td><td><strong>0.236</strong></td><td><strong>0.008</strong></td><td>0.008</td><td>0.008</td><td>0.008</td></tr></tbody></table></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="what-does-the-operation-eu-elasticipidleaddress-do-how-can-i-decrease-this-cost">What does the operation <code>EU-ElasticIP:IdleAddress</code> do? How can I decrease this cost?<a aria-hidden="true" class="hash-link" href="#what-does-the-operation-eu-elasticipidleaddress-do-how-can-i-decrease-this-cost" title="Direct link to heading">​</a></h2><p>I discovered there were two Elastic IP addresses not linked to any EC2 instances, this is why it is been charged in Idle state. I release them manually, through the AWS Console, so no more cost is generated. More details about why it was been charge <a href="https://aws.amazon.com/premiumsupport/knowledge-center/elastic-ip-charges/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>As we want to avoid manual intervention, I made the elastic IP creation depend on the <code>aft_vpc_nat_gateway</code> parameter I introduce for reducing NAT costs in my <a href="/blog/aws/control-tower/1-delete-vpc-endpoints-and-nat">previous post.</a></p><p><img alt="elastic-ip-modification" src="/assets/images/elastic-ip-modification-in-tf-2449beed77d3a358674fd492f865f7f4.png"></p><p><a href="https://github.com/cangulo-aws-aft/terraform-aws-control_tower_account_factory/commit/e11466b8e6beaf4364f0343b5d44f0939050dbf3" target="_blank" rel="noopener noreferrer">Commit</a></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="kms-costs">KMS Costs<a aria-hidden="true" class="hash-link" href="#kms-costs" title="Direct link to heading">​</a></h2><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>I will answer this one in my next post. Too much for this one.</p></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="side-notes">Side Notes:<a aria-hidden="true" class="hash-link" href="#side-notes" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="wait-carlos-were-you-using-the-free-tier">Wait Carlos, were you using the Free Tier?<a aria-hidden="true" class="hash-link" href="#wait-carlos-were-you-using-the-free-tier" title="Direct link to heading">​</a></h3><p>Yes, I was, and that might reduce the final costs I had, but I don&#x27;t expect them to be significantly different nor to change any conclusion of this article. </p><p>Next is my remaining Free Tier quota on April 18, as you see some services already exceeded the free layer though I haven&#x27;t used the AFT resources since later February. </p><p><img alt="free tier stats" src="/assets/images/free-tier-stats-ff8212a040cdbd398e160c3a88f5594b.png"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="audit-and-log-aws-accounts-costs">Audit and Log AWS Accounts costs<a aria-hidden="true" class="hash-link" href="#audit-and-log-aws-accounts-costs" title="Direct link to heading">​</a></h3><p>For using AWS Control Tower there are 3 accounts required:</p><ul><li>Audit Account.</li><li>Log Archive Account.</li><li>AFT Account where all the resources to process account creation request are.</li></ul><p>Next are the costs per account</p><div style="display:flex;justify-content:center"><table><thead><tr><th>Linked Account Name</th><th>cangulo_aft ($)</th><th>Log Archive ($)</th><th>Audit ($)</th></tr></thead><tbody><tr><td>January</td><td>61.2</td><td>1.8</td><td>0.2</td></tr><tr><td>February</td><td>63.3</td><td>1.5</td><td>0.02</td></tr><tr><td>March</td><td>27.2</td><td>2.8</td><td>0.01</td></tr></tbody></table></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>In this post I&#x27;m only referring to the AFT account costs. </p></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="references">References:<a aria-hidden="true" class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ul><li><a href="https://docs.aws.amazon.com/controltower/latest/userguide/getting-started-with-control-tower.html" target="_blank" rel="noopener noreferrer">Starting with Control Tower</a></li><li><a href="https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html" target="_blank" rel="noopener noreferrer">control tower user guide</a></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="git-repositories">Git Repositories<a aria-hidden="true" class="hash-link" href="#git-repositories" title="Direct link to heading">​</a></h3><p><a href="https://github.com/hashicorp/learn-terraform-aft-account-provisioning-customizations" target="_blank" rel="noopener noreferrer">learn-terraform-aft-account-provisioning-customizations</a><br>
<a href="https://github.com/hashicorp/learn-terraform-aft-account-customizations" target="_blank" rel="noopener noreferrer">learn-terraform-aft-account-customizations</a><br>
<a href="https://github.com/hashicorp/learn-terraform-aft-global-customizations" target="_blank" rel="noopener noreferrer">learn-terraform-aft-global-customizations</a><br>
<a href="https://github.com/hashicorp/learn-terraform-aft-account-request" target="_blank" rel="noopener noreferrer">learn-terraform-aft-account-request</a></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="about-me">About me<a aria-hidden="true" class="hash-link" href="#about-me" title="Direct link to heading">​</a></h2><p>I&#x27;m a Software Engineer with experience as Developer and DevOps. The technologies I have worked with are DotNet, Terraform and AWS. For the last one, I have the Developer Associate certification. I define myself as a challenge-seeker person and team player. I simply give it all to deliver high-quality solutions. On the other hand, I like to analyze and improve processes, promote <a href="https://cangulo.github.io/blog/tags/productivity" target="_blank" rel="noopener noreferrer">productivity</a> and <a href="https://cangulo.github.io/meetups/vscode-for-documentation" target="_blank" rel="noopener noreferrer">document implementations</a> (yes, I&#x27;m a developer that likes to document 🧑‍💻).</p><p>You can check my experience <a href="https://cangulo.github.io/about" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Personal Blog - <a href="https://cangulo.github.io" target="_blank" rel="noopener noreferrer">cangulo.github.io</a><br>
<!-- -->GitHub - <a href="https://github.com/cangulo" target="_blank" rel="noopener noreferrer">Carlos Angulo Mascarell - cangulo</a><br>
<!-- -->LinkedIn - <a href="https://www.linkedin.com/in/angulomascarell" target="_blank" rel="noopener noreferrer">Carlos Angulo Mascarell</a><br>
<!-- -->Twitter - <a href="https://twitter.com/angulomascarell" target="_blank" rel="noopener noreferrer">@AnguloMascarell</a></p><div><h2>Did you like it? Share It!</h2><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button aria-label="email" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#7f7f7f"></circle><path d="M17,22v20h30V22H17z M41.1,25L32,32.1L22.9,25H41.1z M20,39V26.6l12,9.3l12-9.3V39H20z" fill="white"></path></svg></button><button aria-label="whatsapp" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#25D366"></circle><path d="m42.32286,33.93287c-0.5178,-0.2589 -3.04726,-1.49644 -3.52105,-1.66732c-0.4712,-0.17346 -0.81554,-0.2589 -1.15987,0.2589c-0.34175,0.51004 -1.33075,1.66474 -1.63108,2.00648c-0.30032,0.33658 -0.60064,0.36247 -1.11327,0.12945c-0.5178,-0.2589 -2.17994,-0.80259 -4.14759,-2.56312c-1.53269,-1.37217 -2.56312,-3.05503 -2.86603,-3.57283c-0.30033,-0.5178 -0.03366,-0.80259 0.22524,-1.06149c0.23301,-0.23301 0.5178,-0.59547 0.7767,-0.90616c0.25372,-0.31068 0.33657,-0.5178 0.51262,-0.85437c0.17088,-0.36246 0.08544,-0.64725 -0.04402,-0.90615c-0.12945,-0.2589 -1.15987,-2.79613 -1.58964,-3.80584c-0.41424,-1.00971 -0.84142,-0.88027 -1.15987,-0.88027c-0.29773,-0.02588 -0.64208,-0.02588 -0.98382,-0.02588c-0.34693,0 -0.90616,0.12945 -1.37736,0.62136c-0.4712,0.5178 -1.80194,1.76053 -1.80194,4.27186c0,2.51134 1.84596,4.945 2.10227,5.30747c0.2589,0.33657 3.63497,5.51458 8.80262,7.74113c1.23237,0.5178 2.1903,0.82848 2.94111,1.08738c1.23237,0.38836 2.35599,0.33657 3.24402,0.20712c0.99159,-0.15534 3.04985,-1.24272 3.47963,-2.45956c0.44013,-1.21683 0.44013,-2.22654 0.31068,-2.45955c-0.12945,-0.23301 -0.46601,-0.36247 -0.98382,-0.59548m-9.40068,12.84407l-0.02589,0c-3.05503,0 -6.08417,-0.82849 -8.72495,-2.38189l-0.62136,-0.37023l-6.47252,1.68286l1.73463,-6.29129l-0.41424,-0.64725c-1.70875,-2.71846 -2.6149,-5.85116 -2.6149,-9.07706c0,-9.39809 7.68934,-17.06155 17.15993,-17.06155c4.58253,0 8.88029,1.78642 12.11655,5.02268c3.23625,3.21036 5.02267,7.50812 5.02267,12.06476c-0.0078,9.3981 -7.69712,17.06155 -17.14699,17.06155m14.58906,-31.58846c-3.93529,-3.80584 -9.1133,-5.95471 -14.62789,-5.95471c-11.36055,0 -20.60848,9.2065 -20.61625,20.52564c0,3.61684 0.94757,7.14565 2.75211,10.26282l-2.92557,10.63564l10.93337,-2.85309c3.0136,1.63108 6.4052,2.4958 9.85634,2.49839l0.01037,0c11.36574,0 20.61884,-9.2091 20.62403,-20.53082c0,-5.48093 -2.14111,-10.64081 -6.03239,-14.51915" fill="white"></path></svg></button><button aria-label="telegram" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#37aee2"></circle><path d="m45.90873,15.44335c-0.6901,-0.0281 -1.37668,0.14048 -1.96142,0.41265c-0.84989,0.32661 -8.63939,3.33986 -16.5237,6.39174c-3.9685,1.53296 -7.93349,3.06593 -10.98537,4.24067c-3.05012,1.1765 -5.34694,2.05098 -5.4681,2.09312c-0.80775,0.28096 -1.89996,0.63566 -2.82712,1.72788c-0.23354,0.27218 -0.46884,0.62161 -0.58825,1.10275c-0.11941,0.48114 -0.06673,1.09222 0.16682,1.5716c0.46533,0.96052 1.25376,1.35737 2.18443,1.71383c3.09051,0.99037 6.28638,1.93508 8.93263,2.8236c0.97632,3.44171 1.91401,6.89571 2.84116,10.34268c0.30554,0.69185 0.97105,0.94823 1.65764,0.95525l-0.00351,0.03512c0,0 0.53908,0.05268 1.06412,-0.07375c0.52679,-0.12292 1.18879,-0.42846 1.79109,-0.99212c0.662,-0.62161 2.45836,-2.38812 3.47683,-3.38552l7.6736,5.66477l0.06146,0.03512c0,0 0.84989,0.59703 2.09312,0.68132c0.62161,0.04214 1.4399,-0.07726 2.14229,-0.59176c0.70766,-0.51626 1.1765,-1.34683 1.396,-2.29506c0.65673,-2.86224 5.00979,-23.57745 5.75257,-27.00686l-0.02107,0.08077c0.51977,-1.93157 0.32837,-3.70159 -0.87096,-4.74991c-0.60054,-0.52152 -1.2924,-0.7498 -1.98425,-0.77965l0,0.00176zm-0.2072,3.29069c0.04741,0.0439 0.0439,0.0439 0.00351,0.04741c-0.01229,-0.00351 0.14048,0.2072 -0.15804,1.32576l-0.01229,0.04214l-0.00878,0.03863c-0.75858,3.50668 -5.15554,24.40802 -5.74203,26.96472c-0.08077,0.34417 -0.11414,0.31959 -0.09482,0.29852c-0.1756,-0.02634 -0.50045,-0.16506 -0.52679,-0.1756l-13.13468,-9.70175c4.4988,-4.33199 9.09945,-8.25307 13.744,-12.43229c0.8218,-0.41265 0.68483,-1.68573 -0.29852,-1.70681c-1.04305,0.24584 -1.92279,0.99564 -2.8798,1.47502c-5.49971,3.2626 -11.11882,6.13186 -16.55882,9.49279c-2.792,-0.97105 -5.57873,-1.77704 -8.15298,-2.57601c2.2336,-0.89555 4.00889,-1.55579 5.75608,-2.23009c3.05188,-1.1765 7.01687,-2.7042 10.98537,-4.24067c7.94051,-3.06944 15.92667,-6.16346 16.62028,-6.43037l0.05619,-0.02283l0.05268,-0.02283c0.19316,-0.0878 0.30378,-0.09658 0.35471,-0.10009c0,0 -0.01756,-0.05795 -0.00351,-0.04566l-0.00176,0zm-20.91715,22.0638l2.16687,1.60145c-0.93418,0.91311 -1.81743,1.77353 -2.45485,2.38812l0.28798,-3.98957" fill="white"></path></svg></button><br style="margin-bottom:15px"></div><section><h2>Comments</h2><div id="hyvor-talk-view"></div></section></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/aws">aws</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/projects">projects</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/accounts">accounts</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/setup">setup</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/costs">costs</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/aws-control-tower">aws-control-tower</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/cangulo/cangulo.github.io/blob/main/blog/posts/aws/control-tower/2-disable-config-in-aft-account.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/aws/control-tower/3-replacing-aws-codepipeline"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« <!-- -->AWS Control Tower - Replacing CodePipelines</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/aws/control-tower/1-delete-vpc-endpoints-and-nat"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">AWS Control Tower - Reducing Cost 1<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#latest-3-months-costs" class="table-of-contents__link toc-highlight">Latest 3 months costs:</a><ul><li><a href="#detailed-cost-services-api-operations-and-usages-type" class="table-of-contents__link toc-highlight">Detailed cost: Services, API Operations and Usages Type</a></li><li><a href="#analysis" class="table-of-contents__link toc-highlight">Analysis</a></li><li><a href="#questions" class="table-of-contents__link toc-highlight">Questions</a></li></ul></li><li><a href="#what-aws-config-does-can-i-reduce-it-cost" class="table-of-contents__link toc-highlight">What AWS Config does? Can I reduce it cost?</a></li><li><a href="#what-does-the-operation-eu-elasticipidleaddress-do-how-can-i-decrease-this-cost" class="table-of-contents__link toc-highlight">What does the operation <code>EU-ElasticIP:IdleAddress</code> do? How can I decrease this cost?</a></li><li><a href="#kms-costs" class="table-of-contents__link toc-highlight">KMS Costs</a></li><li><a href="#side-notes" class="table-of-contents__link toc-highlight">Side Notes:</a><ul><li><a href="#wait-carlos-were-you-using-the-free-tier" class="table-of-contents__link toc-highlight">Wait Carlos, were you using the Free Tier?</a></li><li><a href="#audit-and-log-aws-accounts-costs" class="table-of-contents__link toc-highlight">Audit and Log AWS Accounts costs</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References:</a><ul><li><a href="#git-repositories" class="table-of-contents__link toc-highlight">Git Repositories</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/cheatsheets">Cheatsheets</a></li><li class="footer__item"><a class="footer__link-item" href="/projects">Projects</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.linkedin.com/in/angulomascarell/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/angulomascarell" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/rss">RSS</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.20589720.js"></script>
<script src="/assets/js/main.9d51b9f2.js"></script>
</body>
</html>