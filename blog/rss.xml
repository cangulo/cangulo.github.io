<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Carlos Angulo Blog</title>
        <link>https://cangulo.github.io/blog</link>
        <description>Carlos Angulo Blog</description>
        <lastBuildDate>Mon, 24 Aug 2020 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <item>
            <title><![CDATA[How to use the PowerShell Profile to be more]]></title>
            <link>https://cangulo.github.io/blog/mdx-blog-post</link>
            <guid>mdx-blog-post</guid>
            <pubDate>Mon, 24 Aug 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[In this post, I will explain how to set up shortcuts in the PowerShell Profile. Everything in this article works for PowerShell 5.1 and later.]]></description>
            <content:encoded><![CDATA[<p>In this post, I will explain how to set up shortcuts in the PowerShell Profile. Everything in this article works for PowerShell 5.1 and later.</p><p>If you are a PowerShell (a.k.a. PS) user, I&#x27;m sure at some point you repeat operations as navigating to a specific folder (e.g. your local GitHub repository). Maybe you run a script to clean or prepare your environment. Let&#x27;s define those two scenarios as next:</p><ol><li>Go to your local git repository folder.<ul><li>Code to execute: <code>cd .\source\repos\</code></li></ul></li><li>Execute a script.<ul><li>Code to execute: <code>$HOME\source\repos\TaskManager\startTaskManagerScript.ps1</code></li></ul></li></ol><h2>What is the PS Profile?</h2><p>The PS Profile is a script that is run when the console starts, and it is used to set custom user settings as variables, alias or functions. We can also use it to execute custom commands to prepare our local environment.</p><p>There are different profiles levels, each one with one file and a different combination of user (current or all) and host (current or all) to be applied. To keep this post simple, we are only going to focus on the profile for the <em>Current User</em> and <em>Current Host</em>. Please check the <a href="#post-references">reference</a> section at the end for more details.</p><p>Check your <code>$Profile</code> variable to know where your profile is stored.</p><p><img src="./2020-08-26-configuring-powershell-profile/Profile-variable.png" alt="Profile variables"/></p><h2>Shortcuts</h2><p>The shortcuts we are going to set are functions or aliases depending on the following situations:</p><ol><li><p>If we want to create a shortcut for a command with a set of parameters, we will write a function. For example, <code>goToCustomName</code> as a shortcut for <code>cd [PATH]</code>. The code will be:</p><ul><li><code>function goToCustomName { cd [PATH] }</code></li></ul></li><li><p>If we want to create a shortcut for a command that we use regularly, but with different parameters, we will define an alias. For example, instead of writing <code>Select-String</code>, we can write <code>ss</code>. In our case, the command is a script we execute, and we want to avoid writing the full path, for that we will use the next code:</p><ul><li><code>New-Alias -Name [SCRIPT-ALIAS] -Value [SCRIPT-FULL-PATH]</code></li></ul></li></ol><h3>Creating the profile</h3><p>Let&#x27;s create and open the script file using VS Code by executing the next command in PS: <code>code $PROFILE</code>, you should see the code editor empty.</p><p>Next are the shortcuts we want to add:</p><table><thead><tr><th>shortcut</th><th>type</th><th>full command</th></tr></thead><tbody><tr><td><code>goToRepos</code></td><td>function</td><td><code>cd $HOME\source\repos</code></td></tr><tr><td><code>startTaskManagerAPI</code></td><td>alias</td><td><code>$HOME\source\repos\TaskManager\startTaskManagerScript.ps1</code></td></tr></tbody></table><p>But, as both commands share the <code>$HOME\source\repos</code> path, we could define a variable to make them shorter. Here is the table updated:</p><table><thead><tr><th>shortcut</th><th>type</th><th>full command</th></tr></thead><tbody><tr><td><code>localrepo</code></td><td>variable</td><td><code>$HOME + &#x27;\source\repos&#x27;</code></td></tr><tr><td><code>goToRepos</code></td><td>function</td><td><code>function goToRepos { cd $localRepo }</code></td></tr><tr><td><code>startTaskManagerAPI</code></td><td>alias</td><td><code>New-Alias -Name startTaskManagerAPI -Value $localRepo\TaskManager\startTaskManagerScript.ps1</code></td></tr></tbody></table><p>Please note the <code>$localrepo</code> variable will be available in the PS session so that you can use it anytime as the variable <code>$HOME</code>. Paste the next code in your profile and save it.</p><pre><code class="language-powershell"># Variables

$localRepo = $HOME + &#x27;\source\repos&#x27;

# Functions

function goToRepos { cd $localRepo }

# Alias

New-Alias -Name startTaskManagerAPI -Value $localRepo\TaskManager\startTaskManagerScript.ps1
</code></pre><p>Open a new PS window. Maybe the next error will show up:</p><p><img src="./2020-08-26-configuring-powershell-profile/digitally-signed-problem.png" alt="Problem Signature Profile"/></p><p>That is because PS has an execution policy which only to accept signed scripts (<code>AllSigned</code>). We need to change it to <code>RemoteSigned</code> to verify the signature for remote scripts, but not locals. We have to do it using the next command:</p><p><code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code>. Now we are good to go, open a new PS and try to execute the shortcuts we defined.</p><p><img src="./2020-08-26-configuring-powershell-profile/shortcuts-execution.png" alt="Shortcuts execution"/></p><p>And we&#x27;re done! I hope this helps you to save time when using PS. Do you know any other tweak to be more productive? Feel free to share it in the comments!</p><h2>References</h2><ul><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1">PowerShell Profiles Reference for PS 5.1</a></li><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1#the-profile-files">Profiles Files in PS 5.1</a></li><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-5.1#example-4--create-an-alias-to-an-executable-file">Example 4: Create an alias to an executable file</a></li><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-5.1#example-4--create-an-alias-to-an-executable-file">Example 5: Create an alias for a command with parameters</a></li><li><a href="https://www.tenforums.com/general-support/107659-how-sign-powershell-profile-w-self-signed-certificate.html">How to sign PowerShell profile w/ self-signed certificate?</a></li><li><a href="https://www.hanselman.com/blog/SigningPowerShellScripts.aspx">Signing PowerShell Scripts</a></li></ul><div></div><div slug="cheatsheets/git" title="Git Cheatsheet" tags="git,githooks,alias"></div><div slug="cheatsheets/git"></div>]]></content:encoded>
        </item>
    </channel>
</rss>