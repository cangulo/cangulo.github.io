"use strict";(self.webpackChunkcangulo_github_io=self.webpackChunkcangulo_github_io||[]).push([[7955],{3004:function(e){e.exports=JSON.parse('{"blogPosts":[{"id":"mdx-blog-post","metadata":{"permalink":"/blog/mdx-blog-post","source":"@site/blog/posts/powershell/configuring-powershell-profile/configuring-powershell-profile.mdx","title":"How to use the PowerShell Profile to be more","description":"In this post, I will explain how to set up shortcuts in the PowerShell Profile. Everything in this article works for PowerShell 5.1 and later.","date":"2020-08-24T00:00:00.000Z","formattedDate":"August 24, 2020","tags":[{"label":"windows10","permalink":"/blog/tags/windows-10"},{"label":"productivity","permalink":"/blog/tags/productivity"},{"label":"hack","permalink":"/blog/tags/hack"},{"label":"powershell","permalink":"/blog/tags/powershell"}],"readingTime":3.645,"truncated":true,"authors":[{"name":"Carlos Angulo Mascarell","title":"Software Engineer","url":"https://github.com/cangulo","imageURL":"https://github.com/cangulo/cangulo/raw/main/profile_picture_preview_icon.png","key":"cangulo"}]},"content":"import ShareCard from \'/src/components/blog/share.js\'\\nimport Caption from \'/src/components/blog/caption.js\'\\nimport Comments from \'/src/components/blog/comments.js\'\\nimport AboutMePostArea from \'/src/mdx_components/aboutme_area.mdx\'\\n\\nIn this post, I will explain how to set up shortcuts in the PowerShell Profile. Everything in this article works for PowerShell 5.1 and later.\\n\\n\x3c!--truncate--\x3e\\n\\n\\nIf you are a PowerShell (a.k.a. PS) user, I\'m sure at some point you repeat operations as navigating to a specific folder (e.g. your local GitHub repository). Maybe you run a script to clean or prepare your environment. Let\'s define those two scenarios as next:\\n\\n1. Go to your local git repository folder.\\n   - Code to execute: `cd .\\\\source\\\\repos\\\\`\\n2. Execute a script.\\n   - Code to execute: `$HOME\\\\source\\\\repos\\\\TaskManager\\\\startTaskManagerScript.ps1`\\n\\n# What is the PS Profile?\\n\\nThe PS Profile is a script that is run when the console starts, and it is used to set custom user settings as variables, alias or functions. We can also use it to execute custom commands to prepare our local environment.\\n\\nThere are different profiles levels, each one with one file and a different combination of user (current or all) and host (current or all) to be applied. To keep this post simple, we are only going to focus on the profile for the _Current User_ and _Current Host_. Please check the [reference](#post-references) section at the end for more details.\\n\\nCheck your `$Profile` variable to know where your profile is stored.\\n\\n![Profile variables](./2020-08-26-configuring-powershell-profile/Profile-variable.png)\\n\\n# Shortcuts\\n\\nThe shortcuts we are going to set are functions or aliases depending on the following situations:\\n\\n1. If we want to create a shortcut for a command with a set of parameters, we will write a function. For example, `goToCustomName` as a shortcut for `cd [PATH]`. The code will be:\\n\\n   - `function goToCustomName { cd [PATH] }`\\n\\n2. If we want to create a shortcut for a command that we use regularly, but with different parameters, we will define an alias. For example, instead of writing `Select-String`, we can write `ss`. In our case, the command is a script we execute, and we want to avoid writing the full path, for that we will use the next code:\\n   - `New-Alias -Name [SCRIPT-ALIAS] -Value [SCRIPT-FULL-PATH]`\\n\\n## Creating the profile\\n\\nLet\'s create and open the script file using VS Code by executing the next command in PS: `code $PROFILE`, you should see the code editor empty.\\n\\nNext are the shortcuts we want to add:\\n\\n| shortcut              | type     | full command                                                |\\n| --------------------- | -------- | ----------------------------------------------------------- |\\n| `goToRepos`           | function | `cd $HOME\\\\source\\\\repos`                                     |\\n| `startTaskManagerAPI` | alias    | `$HOME\\\\source\\\\repos\\\\TaskManager\\\\startTaskManagerScript.ps1` |\\n\\nBut, as both commands share the `$HOME\\\\source\\\\repos` path, we could define a variable to make them shorter. Here is the table updated:\\n\\n| shortcut              | type     | full command                                                                                   |\\n| --------------------- | -------- | ---------------------------------------------------------------------------------------------- |\\n| `localrepo`           | variable | `$HOME + \'\\\\source\\\\repos\'`                                                                      |\\n| `goToRepos`           | function | `function goToRepos { cd $localRepo }`                                                         |\\n| `startTaskManagerAPI` | alias    | `New-Alias -Name startTaskManagerAPI -Value $localRepo\\\\TaskManager\\\\startTaskManagerScript.ps1` |\\n\\nPlease note the `$localrepo` variable will be available in the PS session so that you can use it anytime as the variable `$HOME`. Paste the next code in your profile and save it.\\n\\n```shell\\n# Variables\\n\\n$localRepo = $HOME + \'\\\\source\\\\repos\'\\n\\n# Functions\\n\\nfunction goToRepos { cd $localRepo }\\n\\n# Alias\\n\\nNew-Alias -Name startTaskManagerAPI -Value $localRepo\\\\TaskManager\\\\startTaskManagerScript.ps1\\n```\\n\\nOpen a new PS window. Maybe the next error will show up:\\n\\n![Problem Signature Profile](./2020-08-26-configuring-powershell-profile/digitally-signed-problem.png)\\n\\nThat is because PS has an execution policy which only to accept signed scripts (`AllSigned`). We need to change it to `RemoteSigned` to verify the signature for remote scripts, but not locals. We have to do it using the next command:\\n\\n`Set-ExecutionPolicy RemoteSigned -Scope CurrentUser`. Now we are good to go, open a new PS and try to execute the shortcuts we defined.\\n\\n![Shortcuts execution](./2020-08-26-configuring-powershell-profile/shortcuts-execution.png)\\n\\nAnd we\'re done! I hope this helps you to save time when using PS. Do you know any other tweak to be more productive? Feel free to share it in the comments!\\n\\n\\n## References\\n\\n* [PowerShell Profiles Reference for PS 5.1](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1)\\n* [Profiles Files in PS 5.1](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1#the-profile-files)\\n* [Example 4: Create an alias to an executable file](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-5.1#example-4--create-an-alias-to-an-executable-file)\\n* [Example 5: Create an alias for a command with parameters](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-5.1#example-4--create-an-alias-to-an-executable-file)\\n* [How to sign PowerShell profile w/ self-signed certificate?](https://www.tenforums.com/general-support/107659-how-sign-powershell-profile-w-self-signed-certificate.html)\\n* [Signing PowerShell Scripts](https://www.hanselman.com/blog/SigningPowerShellScripts.aspx)\\n\\n\\n<AboutMePostArea/>\\n\\n## Did you like it? Share it\\n\\n<ShareCard \\n  slug=\\"cheatsheets/git\\" \\n  title=\\"Git Cheatsheet\\" \\n  tags={[\\"git\\", \\"githooks\\", \\"alias\\"]} />\\n\\n<Comments\\n  slug=\\"cheatsheets/git\\"  />"}]}')}}]);