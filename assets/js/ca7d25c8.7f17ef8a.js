"use strict";(self.webpackChunkcangulo_github_io=self.webpackChunkcangulo_github_io||[]).push([[7777],{21380:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return m},contentTitle:function(){return h},metadata:function(){return d},assets:function(){return g},toc:function(){return f},default:function(){return w}});var o=a(83117),l=a(80102),n=(a(67294),a(3905)),i=a(64888),r=a(46785),s=a(26684),p=a(93511),c=a(84964),u=["components"],m={slug:"ps-profile-productive",title:"How to use the PowerShell Profile to be more productive",date:new Date("2020-08-24T00:00:00.000Z"),group:"blog",authors:"cangulo",tags:["windows10","productivity","hack","powershell"]},h=void 0,d={permalink:"/blog/ps-profile-productive",editUrl:"https://github.com/cangulo/cangulo.github.io/blob/main/blog/posts/powershell/configuring-powershell-profile/configuring-powershell-profile.mdx",source:"@site/blog/posts/powershell/configuring-powershell-profile/configuring-powershell-profile.mdx",title:"How to use the PowerShell Profile to be more productive",description:"In this post, I will explain how to set up shortcuts in the PowerShell Profile. Everything in this article works for PowerShell 5.1 and later.",date:"2020-08-24T00:00:00.000Z",formattedDate:"August 24, 2020",tags:[{label:"windows10",permalink:"/blog/tags/windows-10"},{label:"productivity",permalink:"/blog/tags/productivity"},{label:"hack",permalink:"/blog/tags/hack"},{label:"powershell",permalink:"/blog/tags/powershell"}],readingTime:2.85,truncated:!0,authors:[{name:"Carlos Angulo Mascarell",title:"Software Engineer",url:"https://github.com/cangulo",imageURL:"https://github.com/cangulo/cangulo/raw/main/profile_picture_preview_icon.png",key:"cangulo"}],prevItem:{title:"Create an interactive bookmarks menu in your terminal",permalink:"/blog/bash/1-interactive-bookmarks"}},g={authorsImageUrls:[void 0]},f=[{value:"What is the PS Profile?",id:"what-is-the-ps-profile",children:[],level:2},{value:"Shortcuts",id:"shortcuts",children:[{value:"Creating the profile",id:"creating-the-profile",children:[],level:3}],level:2},{value:"References",id:"references",children:[],level:2}],k={toc:f};function w(e){var t=e.components,h=(0,l.Z)(e,u);return(0,n.kt)("wrapper",(0,o.Z)({},k,h,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"In this post, I will explain how to set up shortcuts in the PowerShell Profile. Everything in this article works for PowerShell 5.1 and later."),(0,n.kt)("p",null,"If you are a PowerShell (a.k.a. PS) user, I'm sure at some point you repeat operations as navigating to a specific folder (e.g. your local GitHub repository). Maybe you run a script to clean or prepare your environment. Let's define those two scenarios as next:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Go to your local git repository folder.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Code to execute: ",(0,n.kt)("inlineCode",{parentName:"li"},"cd .\\source\\repos\\")))),(0,n.kt)("li",{parentName:"ol"},"Execute a script.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Code to execute: ",(0,n.kt)("inlineCode",{parentName:"li"},"$HOME\\source\\repos\\TaskManager\\startTaskManagerScript.ps1"))))),(0,n.kt)("h2",{id:"what-is-the-ps-profile"},"What is the PS Profile?"),(0,n.kt)("p",null,"The PS Profile is a script that is run when the console starts, setting custom user settings as variables, aliases or functions. We can also use it to execute custom commands to prepare our local environment. Check your ",(0,n.kt)("inlineCode",{parentName:"p"},"$Profile")," variable to know where your profile is stored."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Profile variables",src:a(51815).Z})),(0,n.kt)("h2",{id:"shortcuts"},"Shortcuts"),(0,n.kt)("p",null,"The shortcuts we are going to set are functions or aliases depending on the following situations:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"For a command with static parameters, we will write functions. For example, ",(0,n.kt)("inlineCode",{parentName:"li"},"goToRepos")," as a shortcut for ",(0,n.kt)("inlineCode",{parentName:"li"},"cd $HOME\\source\\repos"),". The code will be:")),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"function NAME { COMMAND_WITH_PARAMS }")," -> ",(0,n.kt)("inlineCode",{parentName:"p"},"function goToRepos { cd $HOME\\source\\repos }")),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"We will define an alias for frequently used commands which we call with different parameters. For example, we use ",(0,n.kt)("inlineCode",{parentName:"li"},"Select-String")," to filter file content as next:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell"},"Select-String [-Pattern] PATTERN [-Path] PATH\n")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(16133).Z})),(0,n.kt)("p",null,"Instead of writing ",(0,n.kt)("inlineCode",{parentName:"p"},"Select-String"),", we could write ",(0,n.kt)("inlineCode",{parentName:"p"},"ss"),". Next is the alias:"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"New-Alias -Name ALIAS -Value COMMAND")," -> ",(0,n.kt)("inlineCode",{parentName:"p"},"New-Alias -Name ss -Value Select-String")),(0,n.kt)("p",null,"In our case, we want to avoid typing the full ",(0,n.kt)("em",{parentName:"p"},"startTaskManagerScript"),", so we set that path as COMMAND."),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"New-Alias -Name startTaskManagerAPI -Value $HOME\\source\\repos\\TaskManager\\startTaskManagerScript.ps1")),(0,n.kt)("h3",{id:"creating-the-profile"},"Creating the profile"),(0,n.kt)("p",null,"Let's create and open the PS profile, execute the following command in PS: ",(0,n.kt)("inlineCode",{parentName:"p"},"code $PROFILE"),", you should see the code editor empty. Considering that both commands share the ",(0,n.kt)("inlineCode",{parentName:"p"},"$HOME\\source\\repos")," path, we could define a variable to short them as next:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell"},"# Variables\n\n$localRepo = $HOME + '\\source\\repos'\n\n# Functions\n\nfunction goToRepos { cd $localRepo }\n\n# Alias\n\nNew-Alias -Name startTaskManagerAPI -Value $localRepo\\TaskManager\\startTaskManagerScript.ps1\n")),(0,n.kt)("p",null,"Please note the ",(0,n.kt)("inlineCode",{parentName:"p"},"$localrepo")," variable will be available during the PS session. This means you can use it anytime, just as the variable ",(0,n.kt)("inlineCode",{parentName:"p"},"$HOME"),". Paste the previous code into your profile and save it."),(0,n.kt)("p",null,"Open a new PS window. Maybe the next error will show up:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Problem Signature Profile",src:a(91716).Z})),(0,n.kt)("p",null,"That is because PS has an execution policy that only accepts signed scripts (",(0,n.kt)("inlineCode",{parentName:"p"},"AllSigned"),"). We need to change it to ",(0,n.kt)("inlineCode",{parentName:"p"},"RemoteSigned")," to verify the signature for remote scripts, but not locals. We have to do it using the following command:"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"Set-ExecutionPolicy RemoteSigned -Scope CurrentUser"),". Now we are good to go, open a new PS and try to execute the shortcuts we defined. "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Shortcuts execution",src:a(78521).Z})),(0,n.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"use the autocomplete feature!")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"You don't need to write your aliases or functions completely. Just type the initial part and press ",(0,n.kt)("inlineCode",{parentName:"p"},"tab"),"."))),(0,n.kt)("p",null,"And we're done! I hope this helps you to save time when using PS. Do you know any other tweak to be more productive? Feel free to share it in the comments!"),(0,n.kt)("h2",{id:"references"},"References"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1"},"PowerShell Profiles Reference for PS 5.1")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1#the-profile-files"},"Profiles Files in PS 5.1")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-5.1#example-4--create-an-alias-to-an-executable-file"},"Example 4: Create an alias to an executable file")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-5.1#example-4--create-an-alias-to-an-executable-file"},"Example 5: Create an alias for a command with parameters")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.tenforums.com/general-support/107659-how-sign-powershell-profile-w-self-signed-certificate.html"},"How to sign PowerShell profile w/ self-signed certificate?")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.hanselman.com/blog/SigningPowerShellScripts.aspx"},"Signing PowerShell Scripts"))),(0,n.kt)(c.ZP,{mdxType:"AboutMe"}),(0,n.kt)(p.ZP,{mdxType:"FullExperienceLink"}),(0,n.kt)(s.ZP,{mdxType:"Contact"}),(0,n.kt)(r.ShareDocusaurus,{preSlug:m.group,slug:m.slug,title:m.title,tags:m.tags,mdxType:"ShareDocusaurus"}),(0,n.kt)(i.Z,{mdxType:"Comments"}))}w.isMDXComponent=!0},64888:function(e,t,a){var o=a(67294),l=a(84610),n=a(52263);t.Z=function(){var e=(0,n.default)().siteConfig,t=parseInt(e.customFields.hyvorTalkSiteId);return o.createElement("section",null,o.createElement("h2",null,"Comments"),o.createElement(l.Z.Embed,{loadMode:"scroll",websiteId:t}))}},51815:function(e,t,a){t.Z=a.p+"assets/images/Profile-variable-dd83c13875811f6393b2199c793769a6.png"},91716:function(e,t,a){t.Z=a.p+"assets/images/digitally-signed-problem-49df164e10bccd4d474971d4266fc8f4.png"},78521:function(e,t,a){t.Z=a.p+"assets/images/shortcuts-execution-e5ac37252d767203df954d218174d824.png"},16133:function(e,t,a){t.Z=a.p+"assets/images/ss-executed-470b7aba3a89a7b8c5dd742ae0bded4d.png"}}]);