"use strict";(self.webpackChunkcangulo_github_io=self.webpackChunkcangulo_github_io||[]).push([[3656],{9012:function(t,e,a){a.r(e),a.d(e,{frontMatter:function(){return p},contentTitle:function(){return d},metadata:function(){return g},assets:function(){return k},toc:function(){return h},default:function(){return f}});var n=a(3117),r=a(102),l=(a(7294),a(3905)),o=a(4888),i=a(6785),s=a(9750),u=a(9741),c=a(8705),m=["components"],p={slug:"aws/2-aws-ct-aft-costs",title:"not finished - AWS Control Tower (AFT) Costs",date:new Date("2022-04-22T00:00:00.000Z"),group:"blog",authors:"cangulo",tags:["aws","projects","accounts","setup","costs"]},d=void 0,g={permalink:"/blog/aws/2-aws-ct-aft-costs",editUrl:"https://github.com/cangulo/cangulo.github.io/blob/main/blog/posts/aws/aft-costs/aws-control-tower-aft-costs.mdx",source:"@site/blog/posts/aws/aft-costs/aws-control-tower-aft-costs.mdx",title:"not finished - AWS Control Tower (AFT) Costs",description:"In this post I'm going to talk about the costs I faced using AWS Control Tower the latest 3 months. I recommend you read my previous posts before continuing. Basic knowledge about AWS Control Tower is required.",date:"2022-04-22T00:00:00.000Z",formattedDate:"April 22, 2022",tags:[{label:"aws",permalink:"/blog/tags/aws"},{label:"projects",permalink:"/blog/tags/projects"},{label:"accounts",permalink:"/blog/tags/accounts"},{label:"setup",permalink:"/blog/tags/setup"},{label:"costs",permalink:"/blog/tags/costs"}],readingTime:2.815,truncated:!0,authors:[{name:"Carlos Angulo Mascarell",title:"Software Engineer",url:"https://github.com/cangulo",imageURL:"https://github.com/cangulo/cangulo/raw/main/profile_picture_preview_icon.png",key:"cangulo"}],nextItem:{title:"Reducing costs when using AWS Control Tower AFT",permalink:"/blog/aws/1-aws-ct-aft-reduce-cost"}},k={authorsImageUrls:[void 0]},h=[{value:"Context",id:"context",children:[{value:"Latest 3 months costs:",id:"latest-3-months-costs",children:[],level:3},{value:"Wait Carlos, were you using the Free Tier?",id:"wait-carlos-were-you-using-the-free-tier",children:[],level:3},{value:"Side Notes: Audit and Log AWS Accounts costs",id:"side-notes-audit-and-log-aws-accounts-costs",children:[],level:3}],level:2},{value:"References:",id:"references",children:[{value:"Git Repositories",id:"git-repositories",children:[],level:3}],level:2}],N={toc:h};function f(t){var e=t.components,d=(0,r.Z)(t,m);return(0,l.kt)("wrapper",(0,n.Z)({},N,d,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"In this post I'm going to talk about the costs I faced using AWS Control Tower the latest 3 months. I recommend you read my ",(0,l.kt)("a",{parentName:"p",href:"/blog/aws/1-aws-ct-aft-reduce-cost"},"previous posts")," before continuing. Basic knowledge about AWS Control Tower is required."))),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"This post is not finished yet"))),(0,l.kt)("h2",{id:"context"},"Context"),(0,l.kt)("p",null,"In my ",(0,l.kt)("a",{parentName:"p",href:"/blog/aws/1-aws-ct-aft-reduce-cost"},"last post")," I explained how I setup the services AWS Control Tower and the Account Factory for Terraform (AFT) approach. Now I'm going to talk about the costs associated."),(0,l.kt)("h3",{id:"latest-3-months-costs"},"Latest 3 months costs:"),(0,l.kt)("p",null,"Before continue I have to mention my usage of AFT:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"January and February were the months I use it. I created 5 AWS Accounts."),(0,l.kt)("li",{parentName:"ul"},"On March I didn't create neither enroll any account. This was on purpose to check what are the fixed costs of having AFT inactive, I knew some Control Tower policies created have fixed costs no mated if you use them or not. I will dive into it in the next sections")),(0,l.kt)("p",null,"And here we have the costs:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"latest 3 months costs",src:a(5306).Z})),(0,l.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Service"),(0,l.kt)("th",{parentName:"tr",align:null},"Config($)"),(0,l.kt)("th",{parentName:"tr",align:null},"VPC($)"),(0,l.kt)("th",{parentName:"tr",align:null},"Tax($)"),(0,l.kt)("th",{parentName:"tr",align:null},"EC2-Other($)"),(0,l.kt)("th",{parentName:"tr",align:null},"CodeBuild($)"),(0,l.kt)("th",{parentName:"tr",align:null},"Key Management Service($)"),(0,l.kt)("th",{parentName:"tr",align:null},"Lambda($)"),(0,l.kt)("th",{parentName:"tr",align:null},"S3($)"),(0,l.kt)("th",{parentName:"tr",align:null},"DynamoDB($)"),(0,l.kt)("th",{parentName:"tr",align:null},"Backup($)"),(0,l.kt)("th",{parentName:"tr",align:null},"EC2-Instances($)"),(0,l.kt)("th",{parentName:"tr",align:null},"CloudWatch($)"),(0,l.kt)("th",{parentName:"tr",align:null},"Total cost ($)"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2022-01-01"),(0,l.kt)("td",{parentName:"tr",align:null},"16.58"),(0,l.kt)("td",{parentName:"tr",align:null},"17.34"),(0,l.kt)("td",{parentName:"tr",align:null},"10.62"),(0,l.kt)("td",{parentName:"tr",align:null},"8.41"),(0,l.kt)("td",{parentName:"tr",align:null},"6.62"),(0,l.kt)("td",{parentName:"tr",align:null},"1.56"),(0,l.kt)("td",{parentName:"tr",align:null},"0.09"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"61.2")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2022-02-01"),(0,l.kt)("td",{parentName:"tr",align:null},"13.9"),(0,l.kt)("td",{parentName:"tr",align:null},"12.5"),(0,l.kt)("td",{parentName:"tr",align:null},"10.98"),(0,l.kt)("td",{parentName:"tr",align:null},"9.04"),(0,l.kt)("td",{parentName:"tr",align:null},"8.5"),(0,l.kt)("td",{parentName:"tr",align:null},"1.87"),(0,l.kt)("td",{parentName:"tr",align:null},"6.44"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"63.22")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2022-03-01"),(0,l.kt)("td",{parentName:"tr",align:null},"9.03"),(0,l.kt)("td",{parentName:"tr",align:null},"0"),(0,l.kt)("td",{parentName:"tr",align:null},"4.72"),(0,l.kt)("td",{parentName:"tr",align:null},"7.44"),(0,l.kt)("td",{parentName:"tr",align:null},"0"),(0,l.kt)("td",{parentName:"tr",align:null},"6"),(0,l.kt)("td",{parentName:"tr",align:null},"0"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"),(0,l.kt)("td",{parentName:"tr",align:null},"0"),(0,l.kt)("td",{parentName:"tr",align:null},"0"),(0,l.kt)("td",{parentName:"tr",align:null},"27.19"))))),(0,l.kt)("h3",{id:"wait-carlos-were-you-using-the-free-tier"},"Wait Carlos, were you using the Free Tier?"),(0,l.kt)("p",null,"Yes I was, and that might reduce the final costs I had but I don't expect them to be significant neither to change any conclusion of this article. I checked the quota I had left on April 18 after not using it since later february, and for some services it was already exceed."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"free tier stats",src:a(9087).Z})),(0,l.kt)("h3",{id:"side-notes-audit-and-log-aws-accounts-costs"},"Side Notes: Audit and Log AWS Accounts costs"),(0,l.kt)("p",null,"For using AWS Control Tower there are 3 accounts required:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Audit Account."),(0,l.kt)("li",{parentName:"ul"},"Log Archive Account."),(0,l.kt)("li",{parentName:"ul"},"AFT Account where all the resources to process account creation request are.")),(0,l.kt)("p",null,"In this post I'm only referring to the AFT accounts costs. Next are all the costs "),(0,l.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Linked Account Name"),(0,l.kt)("th",{parentName:"tr",align:null},"cangulo_aft ($)"),(0,l.kt)("th",{parentName:"tr",align:null},"Log Archive ($)"),(0,l.kt)("th",{parentName:"tr",align:null},"Audit ($)"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2022-01-01"),(0,l.kt)("td",{parentName:"tr",align:null},"61.2"),(0,l.kt)("td",{parentName:"tr",align:null},"1.8"),(0,l.kt)("td",{parentName:"tr",align:null},"0.2")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2022-02-01"),(0,l.kt)("td",{parentName:"tr",align:null},"63.3"),(0,l.kt)("td",{parentName:"tr",align:null},"1.5"),(0,l.kt)("td",{parentName:"tr",align:null},"0.02")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2022-03-01"),(0,l.kt)("td",{parentName:"tr",align:null},"27.2"),(0,l.kt)("td",{parentName:"tr",align:null},"2.8"),(0,l.kt)("td",{parentName:"tr",align:null},"0.01"))))),(0,l.kt)("h2",{id:"references"},"References:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/controltower/latest/userguide/getting-started-with-control-tower.html"},"Starting with Control Tower"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"If you are running ephemeral workloads from accounts in AWS Control Tower, you may see an increase in costs associated with AWS Config. Contact your AWS account representative for more specific information about managing these costs.")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/controltower/latest/userguide/controltower-ug.pdf"},"control tower user guide"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Page 173 -> ",(0,l.kt)("inlineCode",{parentName:"li"},"The detective guardrails are implemented using AWS Config rules")))),(0,l.kt)("li",{parentName:"ul"})),(0,l.kt)("h3",{id:"git-repositories"},"Git Repositories"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/hashicorp/learn-terraform-aft-account-provisioning-customizations"},"learn-terraform-aft-account-provisioning-customizations"),(0,l.kt)("br",{parentName:"p"}),"\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/hashicorp/learn-terraform-aft-account-customizations"},"learn-terraform-aft-account-customizations"),(0,l.kt)("br",{parentName:"p"}),"\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/hashicorp/learn-terraform-aft-global-customizations"},"learn-terraform-aft-global-customizations"),(0,l.kt)("br",{parentName:"p"}),"\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/hashicorp/learn-terraform-aft-account-request"},"learn-terraform-aft-account-request")),(0,l.kt)(c.ZP,{mdxType:"AboutMe"}),(0,l.kt)(u.ZP,{mdxType:"FullExperienceLink"}),(0,l.kt)(s.ZP,{mdxType:"Contact"}),(0,l.kt)(i.ShareDocusaurus,{preSlug:p.group,slug:p.slug,title:p.title,tags:p.tags,mdxType:"ShareDocusaurus"}),(0,l.kt)(o.Z,{mdxType:"Comments"}))}f.isMDXComponent=!0},4888:function(t,e,a){var n=a(7294),r=a(4610),l=a(2263);e.Z=function(){var t=(0,l.default)().siteConfig,e=parseInt(t.customFields.hyvorTalkSiteId);return n.createElement("section",null,n.createElement("h2",null,"Comments"),n.createElement(r.Z.Embed,{loadMode:"scroll",websiteId:e}))}},5306:function(t,e,a){e.Z=a.p+"assets/images/costs-latest-3-months-9eaba09962e4eb993636e391267cb176.png"},9087:function(t,e,a){e.Z=a.p+"assets/images/free-tier-stats-ff8212a040cdbd398e160c3a88f5594b.png"}}]);